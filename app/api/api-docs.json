{"openapi":"3.0.1","info":{"title":"PDF Processor API","description":"API para processamento assíncrono de arquivos PDF","contact":{"name":"PDF Processor Team","email":"support@pdfprocessor.com"},"license":{"name":"MIT License","url":"https://opensource.org/licenses/MIT"},"version":"1.0.0"},"servers":[{"url":"http://localhost:8080","description":"Servidor de desenvolvimento"},{"url":"https://api.pdfprocessor.com","description":"Servidor de produção"}],"tags":[{"name":"Health","description":"Verificações de saúde da aplicação"},{"name":"Operations","description":"Informações sobre operações de processamento suportadas"},{"name":"Monitoring","description":"Endpoints de monitoramento e health check"},{"name":"Jobs","description":"Operações de jobs de processamento de PDF"}],"paths":{"/api/v1/jobs":{"get":{"tags":["Jobs"],"summary":"Listar todos os jobs","description":"Retorna uma lista paginada de todos os jobs","operationId":"listAllJobs","parameters":[{"name":"page","in":"query","description":"Número da página (começando em 0)","required":false,"schema":{"type":"integer","format":"int32","default":0},"example":0},{"name":"size","in":"query","description":"Tamanho da página (1-100)","required":false,"schema":{"type":"integer","format":"int32","default":20},"example":20}],"responses":{"401":{"description":"Não autorizado","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/JobResponse"}}}}},"200":{"description":"Lista de jobs retornada com sucesso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobResponse"},"example":[{"jobId":"550e8400-e29b-41d4-a716-446655440000","operation":"MERGE","status":"COMPLETED","createdAt":"2024-01-15T10:30:00Z","updatedAt":"2024-01-15T10:35:00Z","completedAt":"2024-01-15T10:35:00Z","inputFiles":["job-550e8400/input1.pdf","job-550e8400/input2.pdf"],"outputFiles":["job-550e8400/merged_document.pdf"],"options":{"output_filename":"merged_document.pdf"},"progress":100}]}}}}},"post":{"tags":["Jobs"],"summary":"Criar novo job de processamento","description":"Cria um novo job de processamento de PDF. Você pode enviar arquivos via upload ou referenciar arquivos já existentes no sistema.","operationId":"createJob","parameters":[{"name":"operation","in":"query","description":"Tipo de operação a ser executada","required":true,"schema":{"type":"string"},"examples":{"split":{"description":"Dividir PDF em múltiplos arquivos","value":"split"},"watermark":{"description":"Adicionar marca d'água","value":"watermark"},"encrypt":{"description":"Criptografar PDF","value":"encrypt"},"merge":{"description":"Combinar múltiplos PDFs","value":"merge"}}},{"name":"inputFiles","in":"query","description":"Lista de caminhos de arquivos já existentes no sistema","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"optionsJson","in":"query","description":"Opções específicas da operação em formato JSON","required":false,"schema":{"type":"string"},"examples":{"watermark_options":{"description":"Opções para watermark","value":{"text":"CONFIDENCIAL","opacity":0.5,"position":"center"}},"encrypt_options":{"description":"Opções para encrypt","value":{"user_password":"1234","owner_password":"admin","permissions":["print"]}},"merge_options":{"description":"Opções para merge","value":{"output_filename":"merged.pdf"}},"split_options":{"description":"Opções para split","value":{"pages_per_file":5,"output_prefix":"page_"}}}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"files":{"type":"array","description":"Arquivos PDF para upload (opcional se inputFiles for fornecido)","items":{"type":"string","format":"binary"}}}}}}},"responses":{"200":{"description":"Job criado com sucesso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobResponse"},"example":{"jobId":"550e8400-e29b-41d4-a716-446655440000","operation":"MERGE","status":"PENDING","createdAt":"2024-01-15T10:30:00Z","updatedAt":"2024-01-15T10:30:00Z","inputFiles":["job-550e8400/input1.pdf","job-550e8400/input2.pdf"],"options":{"output_filename":"merged_document.pdf"},"progress":0}}}},"401":{"description":"Não autorizado - X-API-Key inválida ou ausente","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JobResponse"}}}},"422":{"description":"Dados não processáveis","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JobResponse"}}}},"400":{"description":"Requisição inválida","content":{"application/json":{"example":{"error":"Bad Request","message":"Operation parameter is required","timestamp":"2024-01-15T10:30:00Z"}}}},"413":{"description":"Arquivo muito grande","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JobResponse"}}}}}}},"/api/v1/operations":{"get":{"tags":["Operations"],"summary":"Listar todas as operações suportadas","operationId":"getSupportedOperations","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OperationInfo"}}}}}}}},"/api/v1/operations/{operation}":{"get":{"tags":["Operations"],"summary":"Obter informações sobre uma operação específica","operationId":"getOperationInfo","parameters":[{"name":"operation","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/OperationInfo"}}}}}}},"/api/v1/operations/{operation}/schema":{"get":{"tags":["Operations"],"summary":"Obter esquema de opções para uma operação","operationId":"getOperationSchema","parameters":[{"name":"operation","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/v1/monitoring/metrics":{"get":{"tags":["Monitoring"],"summary":"Métricas básicas do sistema","operationId":"metrics","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/v1/monitoring/health":{"get":{"tags":["Monitoring"],"summary":"Health check detalhado do sistema","operationId":"healthCheck","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/v1/jobs/{jobId}":{"get":{"tags":["Jobs"],"summary":"Obter status do job","description":"Retorna o status atual e detalhes de um job específico","operationId":"getJobStatus","parameters":[{"name":"jobId","in":"path","description":"ID único do job","required":true,"schema":{"type":"string"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"401":{"description":"Não autorizado","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JobResponse"}}}},"200":{"description":"Status do job retornado com sucesso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobResponse"},"examples":{"completed":{"description":"Job concluído","value":{"jobId":"550e8400-e29b-41d4-a716-446655440000","operation":"MERGE","status":"COMPLETED","createdAt":"2024-01-15T10:30:00Z","updatedAt":"2024-01-15T10:35:00Z","completedAt":"2024-01-15T10:35:00Z","inputFiles":["job-550e8400/input1.pdf","job-550e8400/input2.pdf"],"outputFiles":["job-550e8400/merged_document.pdf"],"options":{"output_filename":"merged_document.pdf"},"progress":100}},"processing":{"description":"Job em processamento","value":{"jobId":"660f9511-f3ac-52e5-b827-557766551111","operation":"SPLIT","status":"PROCESSING","createdAt":"2024-01-15T10:32:00Z","updatedAt":"2024-01-15T10:33:00Z","inputFiles":["job-660f9511/document.pdf"],"options":{"pages_per_file":5},"progress":45}},"failed":{"description":"Job com erro","value":{"jobId":"770g0622-g4bd-63f6-c938-668877662222","operation":"DECRYPT","status":"FAILED","createdAt":"2024-01-15T10:40:00Z","updatedAt":"2024-01-15T10:41:00Z","inputFiles":["job-770g0622/encrypted.pdf"],"options":{"password":"wrong_password"},"progress":0,"errorMessage":"Invalid password for encrypted PDF"}}}}}},"404":{"description":"Job não encontrado","content":{"application/json":{"example":{"error":"Not Found","message":"Job with ID 550e8400-e29b-41d4-a716-446655440000 not found","timestamp":"2024-01-15T10:30:00Z"}}}}}},"delete":{"tags":["Jobs"],"summary":"Cancelar job","description":"Cancela um job em execução ou pendente","operationId":"cancelJob","parameters":[{"name":"jobId","in":"path","description":"ID único do job","required":true,"schema":{"type":"string"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"401":{"description":"Não autorizado","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JobResponse"}}}},"200":{"description":"Job cancelado com sucesso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobResponse"},"example":{"jobId":"550e8400-e29b-41d4-a716-446655440000","operation":"MERGE","status":"CANCELLED","createdAt":"2024-01-15T10:30:00Z","updatedAt":"2024-01-15T10:32:00Z","inputFiles":["job-550e8400/input1.pdf","job-550e8400/input2.pdf"],"options":{"output_filename":"merged_document.pdf"},"progress":25}}}},"409":{"description":"Job não pode ser cancelado (já concluído ou falhou)","content":{"application/json":{"example":{"error":"Conflict","message":"Cannot cancel job in COMPLETED status","timestamp":"2024-01-15T10:30:00Z"}}}},"404":{"description":"Job não encontrado","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JobResponse"}}}}}}},"/api/v1/jobs/{jobId}/events":{"get":{"tags":["Jobs"],"summary":"Acompanhar progresso do job em tempo real","description":"Estabelece uma conexão Server-Sent Events (SSE) para receber atualizações em tempo real do progresso de um job específico","operationId":"streamJobEvents","parameters":[{"name":"jobId","in":"path","description":"ID único do job","required":true,"schema":{"type":"string"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"401":{"description":"Não autorizado","content":{"text/event-stream":{"schema":{"$ref":"#/components/schemas/SseEmitter"}}}},"200":{"description":"Conexão SSE estabelecida com sucesso","content":{"text/event-stream":{"examples":{"job_update":{"description":"Atualização de progresso","value":"event: job-update\ndata: {\"jobId\":\"550e8400-e29b-41d4-a716-446655440000\",\"operation\":\"MERGE\",\"status\":\"PROCESSING\",\"progress\":45}\n\n"},"job_finished":{"description":"Job concluído","value":"event: job-finished\ndata: {\"jobId\":\"550e8400-e29b-41d4-a716-446655440000\",\"operation\":\"MERGE\",\"status\":\"COMPLETED\",\"progress\":100}\n\n"}}}}},"404":{"description":"Job não encontrado","content":{"text/event-stream":{"schema":{"$ref":"#/components/schemas/SseEmitter"}}}}}}},"/api/v1/jobs/{jobId}/download":{"get":{"tags":["Jobs"],"summary":"Download do resultado do job","description":"Faz o download do arquivo resultado de um job concluído. Para operações que geram múltiplos arquivos, retorna um ZIP.","operationId":"downloadResult","parameters":[{"name":"jobId","in":"path","description":"ID único do job","required":true,"schema":{"type":"string"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"401":{"description":"Não autorizado","content":{"*/*":{"schema":{"type":"string","format":"binary"}}}},"200":{"description":"Arquivo resultado retornado com sucesso","content":{"application/pdf":{"schema":{"type":"string","format":"binary"}},"application/zip":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}},"image/jpeg":{"schema":{"type":"string","format":"binary"}},"text/plain":{"schema":{"type":"string"}},"application/json":{"schema":{"type":"object"}}}},"404":{"description":"Job não encontrado ou resultado não disponível","content":{"application/json":{"examples":{"job_not_found":{"description":"Job não encontrado","value":{"error":"Not Found","message":"Job with ID 550e8400-e29b-41d4-a716-446655440000 not found","timestamp":"2024-01-15T10:30:00Z"}},"result_not_ready":{"description":"Resultado não disponível","value":{"error":"Not Found","message":"Job result not available. Current status: PROCESSING","timestamp":"2024-01-15T10:30:00Z"}}}}}}}}},"/api/v1/health":{"get":{"tags":["Health"],"summary":"Verificação básica de saúde","description":"Retorna o status básico da aplicação","operationId":"health","responses":{"200":{"description":"Status da aplicação","content":{"application/json":{"example":{"status":"UP","timestamp":"2024-01-15T10:30:00","service":"pdf-processor-api","version":"1.0.0"}}}}}}},"/api/v1/health/detailed":{"get":{"tags":["Health"],"summary":"Verificação detalhada de saúde","description":"Retorna o status detalhado da aplicação incluindo componentes (fila Redis e storage)","operationId":"detailedHealth","responses":{"200":{"description":"Status detalhado da aplicação","content":{"application/json":{"examples":{"all_up":{"description":"Todos os componentes funcionando","value":{"status":"UP","timestamp":"2024-01-15T10:30:00","service":"pdf-processor-api","version":"1.0.0","components":{"queue":{"status":"UP","size":5},"storage":{"status":"UP","basePath":"./storage"}}}},"degraded":{"description":"Alguns componentes com problemas","value":{"status":"DEGRADED","timestamp":"2024-01-15T10:30:00","service":"pdf-processor-api","version":"1.0.0","components":{"queue":{"status":"DOWN","error":"Connection refused"},"storage":{"status":"UP","basePath":"./storage"}}}}}}}}}}}},"components":{"schemas":{"JobResponse":{"type":"object","properties":{"id":{"type":"string"},"operation":{"type":"string","enum":["MERGE","SPLIT","COMPRESS","PDF_TO_IMAGES","IMAGES_TO_PDF","ROTATE","WATERMARK","ENCRYPT","DECRYPT","EXTRACT_METADATA","EXTRACT_TEXT","PDF_CROP","PDF_REORDER","PDF_RESIZE","PDF_COMPARE","PDF_CREATE","PDF_EDIT","PDF_PROTECT","PDF_UNLOCK","PDF_OPTIMIZE","PDF_VALIDATE","PDF_REPAIR","PDF_EXTRACT_RESOURCES","PDF_REMOVE_RESOURCES","PDF_TO_PDFA","PDF_OCR","PDF_TO_AUDIO","PDF_FROM_EPUB","PDF_FROM_DJVU"]},"status":{"type":"string","enum":["PENDING","PROCESSING","COMPLETED","FAILED","CANCELLED"]},"inputFiles":{"type":"array","items":{"type":"string"}},"options":{"type":"object","additionalProperties":{"type":"object"}},"errorMessage":{"type":"string"},"resultPath":{"type":"string"},"progress":{"type":"integer","format":"int32"},"createdAt":{"type":"string","format":"date-time"},"startedAt":{"type":"string","format":"date-time"},"completedAt":{"type":"string","format":"date-time"}}},"OperationInfo":{"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"},"optionsSchema":{"type":"object","additionalProperties":{"type":"object"}}}},"SseEmitter":{"type":"object","properties":{"timeout":{"type":"integer","format":"int64"}}}}}}